{
  "swagger": "2.0",
  "info": {
    "description": "This API generates a guarantee order.",
    "version": "1.0.0",
    "title": "Guarantee API."
  },
  "host": "api-sandbox.commerzbank.com",
  "basePath": "/loans-api/1/v1-s",
  "schemes": [
    "https"
  ],
  "tags": [
    {
      "name": "guaranteeOrder"
    }
  ],
  "paths": {
    "/guaranteeOrders": {
      "post": {
        "tags": [
          "guaranteeOrder"
        ],
        "summary": "Generate a guarantee order",
        "operationId": "generateGuaranteeOrder",
        "description": "Generate a new guarantee order.\n",
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "description": "data",
            "required": true,
            "in": "body",
            "name": "data",
            "schema": {
              "$ref": "#/definitions/guarantee"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Successful generated guarantee"
          },
          "400": {
            "description": "Bad Request",
            "schema": {
              "$ref": "#/definitions/problem"
            }
          },
          "401": {
            "description": "Unauthorized",
            "schema": {
              "$ref": "#/definitions/problem"
            }
          },
          "403": {
            "description": "Forbidden",
            "schema": {
              "$ref": "#/definitions/problem"
            }
          },
          "500": {
            "description": "Internal Server Error",
            "schema": {
              "$ref": "#/definitions/problem"
            }
          }
        }
      }
    },
    "/healthcheck": {
      "get": {
        "summary": "Returns status of backend service",
        "description": "If backend Service is working correctly, resource will respond with 200 - OK.",
        "operationId": "getHealthcheck",
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    }
  },
  "definitions": {
    "address": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "name2": {
          "type": "string"
        },
        "street": {
          "type": "string"
        },
        "city": {
          "type": "string"
        }
      }
    },
    "amount": {
      "type": "object",
      "properties": {
        "value": {
          "type": "number"
        },
        "currency": {
          "type": "string"
        }
      }
    },
    "party": {
      "type": "object",
      "properties": {
        "identifier": {
          "type": "string"
        },
        "identifierCode": {
          "type": "string"
        },
        "address": {
          "$ref": "#/definitions/address"
        }
      }
    },
    "problem": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string",
          "example": "Service Unavailable",
          "description": "A short, summary of the problem type. Written in english and readable for engineers (usually not suited for non technical stakeholders and not localized)"
        },
        "status": {
          "type": "integer",
          "format": "int32",
          "example": 503,
          "description": "The HTTP status code generated by the origin server for this occurrence of the problem."
        },
        "detail": {
          "type": "string",
          "example": "Connection to database timed out",
          "description": "A human-readable explanation specific to this occurrence of the problem."
        }
      }
    },
    "guarantee": {
      "type": "object",
      "required": [
        "customerReferenceNumber",
        "guarantee",
        "parties",
        "amounts",
        "validity",
        "underlyingDetails"
      ],
      "properties": {
        "customerReferenceNumber": {
          "description": "customer reference number",
          "type": "string"
        },
        "guarantee": {
          "type": "object",
          "required": [
            "kind",
            "type",
            "form",
            "applicableRules",
            "wording"
          ],
          "properties": {
            "kind": {
              "description": "kind of guarantee",
              "type": "string",
              "enum": [
                "GUAR",
                "STLC",
                "SPDM",
                "URT"
              ]
            },
            "type": {
              "description": "type of guarantee",
              "type": "string",
              "enum": [
                "TEND",
                "ADVP",
                "PGDO",
                "PGWO",
                "PGCO",
                "PAYM",
                "CRED",
                "BILL",
                "LEAS",
                "CUST",
                "OTHR"
              ]
            },
            "form": {
              "description": "form of the guarantee",
              "type": "string",
              "enum": [
                "DIRC",
                "INDC"
              ]
            },
            "applicableRules": {
              "description": "applicableRules of guarantee",
              "type": "object",
              "properties": {
                "code": {
                  "type": "string",
                  "enum": [
                    "NONE",
                    "URDG",
                    "ISPR",
                    "OTHR"
                  ]
                },
                "ruleDescription": {
                  "type": "string"
                }
              }
            },
            "wording": {
              "required": [
                "wording"
              ],
              "type": "object",
              "properties": {
                "wording": {
                  "description": "Wording of Guarantee",
                  "type": "string",
                  "enum": [
                    "STND",
                    "WDAP",
                    "WDBF"
                  ]
                },
                "specialTerms": {
                  "description": "special terms that should apply to the undertaking in case that the wording of the undertaking should be the standard working of the issuing bank",
                  "type": "string",
                  "enum": [
                    "EFCT",
                    "REDC",
                    "RULE",
                    "EFRE"
                  ]
                },
                "details": {
                  "description": "terms, conditions and details of guarentee",
                  "type": "string"
                },
                "language": {
                  "description": "language code of the standard wording (iso 639 language code)",
                  "type": "string"
                }
              }
            }
          }
        },
        "parties": {
          "description": "parties of guarantee",
          "type": "object",
          "required": [
            "applicant",
            "beneficiary"
          ],
          "properties": {
            "applicant": {
              "type": "object",
              "properties": {
                "address": {
                  "$ref": "#/definitions/address"
                },
                "customerContact": {
                  "description": "contact details of costumer",
                  "type": "object",
                  "properties": {
                    "address": {
                      "$ref": "#/definitions/address"
                    }
                  }
                },
                "customerIdentifier": {
                  "description": "identifier of customer",
                  "type": "object",
                  "properties": {
                    "code": {
                      "type": "string",
                      "enum": [
                        "BICC",
                        "OTHR"
                      ]
                    },
                    "identifier": {
                      "type": "string"
                    }
                  }
                }
              }
            },
            "alternativeApplicant": {
              "type": "object",
              "properties": {
                "address": {
                  "$ref": "#/definitions/address"
                },
                "indicatorOfAlternativeBeneficialOwner": {
                  "description": "indicates, in case that an Alternative Applicant exists, whether the Applicant is acting on its own behalf or for account of a Third Party",
                  "type": "string",
                  "enum": [
                    "OWNB",
                    "ACTP",
                    "RULE"
                  ],
                  "default": "OWNB"
                }
              }
            },
            "beneficiary": {
              "description": "specifies the party in favour of which the guarantee is being issued",
              "type": "object",
              "properties": {
                "address": {
                  "$ref": "#/definitions/address"
                },
                "beneficiaryContact": {
                  "description": "contact details of beneficiary",
                  "type": "object",
                  "properties": {
                    "address": {
                      "$ref": "#/definitions/address"
                    }
                  }
                }
              }
            },
            "issuingBank": {
              "description": "specifies the party that issues the undertaking",
              "$ref": "#/definitions/party"
            },
            "advisingBank": {
              "description": "specifies the advising bank",
              "type": "object",
              "properties": {
                "party": {
                  "$ref": "#/definitions/party"
                },
                "confirmationIndicator": {
                  "description": "confirmation instructions from the issuing bank",
                  "type": "string",
                  "enum": [
                    "CONFIRM",
                    "WITHOUT",
                    "MAY_ADD"
                  ]
                }
              }
            }
          }
        },
        "amounts": {
          "type": "object",
          "required": [
            "amount"
          ],
          "properties": {
            "amount": {
              "type": "object",
              "description": "specifies the type of guarantee amount, the currency code of the amount and the amount of the guarantee",
              "required": [
                "amount"
              ],
              "properties": {
                "amountType": {
                  "description": "type of guarantee",
                  "type": "string",
                  "enum": [
                    "PRIN",
                    "IINT",
                    "ICST",
                    "IIAC",
                    "XINT",
                    "XCST",
                    "XIAC"
                  ],
                  "default": "IIAC"
                },
                "amount": {
                  "$ref": "#/definitions/amount"
                }
              }
            },
            "additionalAmount": {
              "description": "specify additional amounts e. g. interest",
              "type": "string"
            }
          }
        },
        "validity": {
          "type": "object",
          "required": [
            "validityType"
          ],
          "properties": {
            "validityType": {
              "description": "specifies whether the validity of the guarantee is limited or unlimited.",
              "type": "string",
              "enum": [
                "LIMT",
                "UNLM"
              ]
            },
            "expireDate": {
              "description": "date of expire for limited guarantees",
              "type": "string",
              "format": "date"
            },
            "approximateExpireDate": {
              "description": "date of expire for unlimited guarantees",
              "type": "string",
              "format": "date"
            },
            "specificationOfExpiry": {
              "description": "the expiry of the guarantee in free text form (no date is avaliable)",
              "type": "string"
            }
          }
        },
        "delivery": {
          "type": "object",
          "properties": {
            "deliveryOforiginalGuarantee": {
              "description": "method of transmission of original undertaking",
              "type": "object",
              "properties": {
                "method": {
                  "type": "object",
                  "description": "specifies the type of guarantee amount, the currency code of the amount and the amount of the guarantee",
                  "properties": {
                    "guaranteeType": {
                      "description": "type of guarantee",
                      "type": "string",
                      "enum": [
                        "COUR",
                        "MAIL",
                        "REGM",
                        "MESS",
                        "RULE"
                      ]
                    }
                  }
                },
                "additionalInformation": {
                  "type": "string",
                  "description": "additional information"
                }
              }
            },
            "deliveryTo": {
              "description": "specification who gets the original undertaking",
              "type": "string",
              "enum": [
                "BENE",
                "APPL",
                "ALTA",
                "SPEC"
              ]
            },
            "address": {
              "description": "addresse who gehts the original undertaking",
              "$ref": "#/definitions/address"
            }
          }
        },
        "accounts": {
          "type": "object",
          "properties": {
            "liabilityAccount": {
              "description": "specifies the number of the liability account",
              "type": "string"
            },
            "chargesAccount": {
              "description": "specifies the number of the charges account",
              "type": "string"
            }
          }
        },
        "underlyingDetails": {
          "type": "object",
          "required": [
            "liabilityDetails"
          ],
          "properties": {
            "liabilityDetails": {
              "description": "description of liability",
              "type": "string"
            },
            "reference": {
              "description": "defines a reference associated with the guarantee",
              "type": "object",
              "properties": {
                "code": {
                  "type": "string",
                  "enum": [
                    "TEND",
                    "ORDR",
                    "OFFR",
                    "DELV",
                    "PINV",
                    "PROJ",
                    "CONT"
                  ]
                },
                "referenceNumber": {
                  "type": "string"
                }
              }
            },
            "referenceDate": {
              "description": "date of reference (optional a second date)",
              "type": "object",
              "properties": {
                "date": {
                  "type": "string",
                  "format": "date"
                },
                "optionalDate": {
                  "type": "string",
                  "format": "date"
                }
              }
            },
            "contractAmount": {
              "description": "total amount of the order",
              "$ref": "#/definitions/amount"
            },
            "valueInPercent": {
              "description": "undertaking value in percent",
              "type": "string"
            }
          }
        },
        "corporateToBankInformation": {
          "description": "contains additional information for the Receiver",
          "type": "string"
        }
      }
    }
  },
  "securityDefinitions": {
    "OAuth (Sandbox) Password": {
      "type": "oauth2",
      "description": "The tokenmanager used for sandbox services.",
      "flow": "password",
      "tokenUrl": "https://api-sandbox.commerzbank.com/auth/realms/sandbox/protocol/openid-connect/token",
      "scopes": {}
    },
    "OAuth (Sandbox) AuthorizationCode": {
      "type": "oauth2",
      "description": "The tokenmanager used for sandbox services.",
      "flow": "accessCode",
      "authorizationUrl": "https://api-sandbox.commerzbank.com/auth/realms/sandbox/protocol/openid-connect/auth",
      "tokenUrl": "https://api-sandbox.commerzbank.com/auth/realms/sandbox/protocol/openid-connect/token",
      "scopes": {}
    }
  }
}